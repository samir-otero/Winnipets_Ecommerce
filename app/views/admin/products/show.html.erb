<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
  <h1 class="h2"><%= @product.name %></h1>
  <div class="btn-toolbar mb-2 mb-md-0">
    <div class="btn-group me-2">
      <%= link_to "Edit", edit_admin_product_path(@product), class: "btn btn-primary" %>
      <%= link_to "Delete", admin_product_path(@product), method: :delete,
                 class: "btn btn-outline-danger",
                 confirm: "Are you sure you want to delete '#{@product.name}'? This action cannot be undone.",
                 data: {
                   confirm: "Are you sure you want to delete '#{@product.name}'? This action cannot be undone.",
                   method: :delete
                 } %>
    </div>
    <%= link_to "← Back to Products", admin_products_path, class: "btn btn-outline-secondary" %>
  </div>
</div>

<div class="row">
  <div class="col-md-8">
    <!-- Product Images -->
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0">Product Images</h5>
      </div>
      <div class="card-body">
        <% if @product.images.attached? %>
          <div class="row">
            <% @product.images.each do |image| %>
              <div class="col-md-4 mb-3">
                <%= image_tag image, class: "img-fluid rounded" %>
              </div>
            <% end %>
          </div>
        <% else %>
          <div class="text-center py-4">
            <i class="bi bi-image display-1 text-muted"></i>
            <p class="text-muted mt-2">No images uploaded</p>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Product Description -->
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0">Description</h5>
      </div>
      <div class="card-body">
        <% if @product.description.present? %>
          <%= simple_format(@product.description) %>
        <% else %>
          <p class="text-muted">No description available.</p>
        <% end %>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <!-- Product Details -->
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0">Product Details</h5>
      </div>
      <div class="card-body">
        <dl class="row">
          <dt class="col-sm-4">SKU:</dt>
          <dd class="col-sm-8"><code><%= @product.sku %></code></dd>

          <dt class="col-sm-4">Category:</dt>
          <dd class="col-sm-8">
            <span class="badge bg-secondary"><%= @product.category.name %></span>
          </dd>

          <dt class="col-sm-4">Price:</dt>
          <dd class="col-sm-8">
            <% if @product.on_sale? %>
              <span class="text-muted text-decoration-line-through">$<%= number_with_precision(@product.price, precision: 2) %></span>
              <br>
              <strong class="text-danger">$<%= number_with_precision(@product.sale_price, precision: 2) %></strong>
              <small class="text-success d-block">On Sale!</small>
            <% else %>
              <strong>$<%= number_with_precision(@product.price, precision: 2) %></strong>
            <% end %>
          </dd>

          <dt class="col-sm-4">Stock:</dt>
          <dd class="col-sm-8">
            <% if @product.stock_quantity > 10 %>
              <span class="badge bg-success"><%= @product.stock_quantity %> in stock</span>
            <% elsif @product.stock_quantity > 0 %>
              <span class="badge bg-warning"><%= @product.stock_quantity %> remaining</span>
            <% else %>
              <span class="badge bg-danger">Out of Stock</span>
            <% end %>
          </dd>

          <% if @product.weight.present? %>
            <dt class="col-sm-4">Weight:</dt>
            <dd class="col-sm-8"><%= @product.weight %> kg</dd>
          <% end %>

          <dt class="col-sm-4">Status:</dt>
          <dd class="col-sm-8">
            <% if @product.is_active? %>
              <span class="badge bg-success">Active</span>
            <% else %>
              <span class="badge bg-danger">Inactive</span>
            <% end %>
          </dd>

          <dt class="col-sm-4">Created:</dt>
          <dd class="col-sm-8"><%= @product.created_at.strftime("%B %d, %Y") %></dd>

          <dt class="col-sm-4">Updated:</dt>
          <dd class="col-sm-8"><%= @product.updated_at.strftime("%B %d, %Y") %></dd>
        </dl>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">Quick Actions</h5>
      </div>
      <div class="card-body">
        <%= link_to edit_admin_product_path(@product), class: "btn btn-primary w-100 mb-2" do %>
          <i class="bi bi-pencil"></i> Edit Product
        <% end %>

        <% if @product.is_active? %>
          <%= link_to admin_product_path(@product), method: :patch,
                     params: { product: { is_active: false } },
                     class: "btn btn-warning w-100 mb-2",
                     confirm: "Are you sure you want to deactivate this product?" do %>
            <i class="bi bi-pause-circle"></i> Deactivate
          <% end %>
        <% else %>
          <%= link_to admin_product_path(@product), method: :patch,
                     params: { product: { is_active: true } },
                     class: "btn btn-success w-100 mb-2" do %>
            <i class="bi bi-play-circle"></i> Activate
          <% end %>
        <% end %>

        <%= link_to admin_products_path, class: "btn btn-outline-secondary w-100" do %>
          <i class="bi bi-arrow-left"></i> Back to Products
        <% end %>
      </div>
    </div>
  </div>
</div>